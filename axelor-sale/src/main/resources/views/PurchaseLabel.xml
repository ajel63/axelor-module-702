<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_6.1.xsd">

  <grid name="shipment-purchase-label-grid" title="PurchaseLabel"
    model="com.axelor.apps.sale.db.PurchaseLabel">
    <field name="billInfo"/>
    <field name="referenceField1"/>
    <field name="referenceField2"/>
    <field name="carrier"/>
    <field name="shipPackage"/>
    <field name="phoneNumber"/>
    <field name="emailAddress"/>
  </grid>

  <form name="shipment-purchase-label-form" title="Purchase Label" canDelete="false"
    onNew="action-purchase-lable-group-on-new" model="com.axelor.apps.sale.db.PurchaseLabel" >
    <panel name="packPanel">
      <field name="billInfo" colSpan="4"/>
      <spacer colSpan="8"/>
      <field name="referenceField1" colSpan="4"/>
      <spacer colSpan="8"/>
      <field name="referenceField2" colSpan="4"/>
      <spacer colSpan="8"/>
      <field name="carrier" colSpan="4"/>
      <field name="shipPackage" colSpan="4"/>
      <spacer colSpan="4"/>
      <field name="labelFileType" colSpan="4"/>
      <spacer colSpan="8"/>
      <field name="phoneNumber" colSpan="4"/>
      <spacer colSpan="8"/>
      <field name="emailAddress" colSpan="4"/>
    </panel>

    <panel>
      <button onClick="save,action-purchase-lable-methos-get-shipment-rates,save"
        readonlyIf="isShippingConfirm" name="getshippingRateBtn" title="Get Shipment Rates"/>
    </panel>

    <panel-related field="purchaseLabelRateLine" name="purchaseLabelRateLinePanel"
      colSpan="12" grid-view="shipment-purchase-label-rate-line-grid" canEdit="true"
      form-view="shipment-purchase-label-rate-line-form"/>

    <panel>
      <button onClick="save,action-purchase-lable-group-confirm-shipping-service,save,close" colSpan="3"
        readonlyIf="isShippingConfirm" name="confirmBtn" prompt="Confirm Service selection?"
        title="Confirm Shipping Service"/>

      <button onClick="save,close" name="confirmBtn"
        prompt="Are you sure you want to cancel Shipping lable?" title="Cancel Shipping Lable"
        colSpan="3"/>
      <field name="selectedRate" colSpan="3" readonly="true"/>
      <field name="isShippingConfirm" colSpan="3" readonly="true"/>
    </panel>

    <panel>
      <field name="trackingNumber" colSpan="6" readonly="true"/>
      <spacer colSpan="6"/>
      <field name="lableUrl" colSpan="12" readonly="true">
        <viewer depends="lableUrl"><![CDATA[
		      <div>
		        <span ng-show="record.lableUrl != null" ><a href={{record.lableUrl}} target="_blank">Lable Link</a></span>
		      </div>
		    ]]></viewer>
      </field>
    </panel>
  </form>

  <action-method name="action-purchase-lable-methos-get-shipment-rates">
    <call class="com.axelor.apps.sale.web.PurchaseLableController"
      method="getPurchaseLableRates"/>
  </action-method>

  <action-group name="action-purchase-lable-group-on-new">
    <action name="action-purchase-lable-attrs-set-attributes"/>
    <action name="action-purchase-lable-method-set-attributes"/>
  </action-group>

  <action-group name="action-purchase-lable-group-confirm-shipping-service">
    <action name="action-purchase-lable-method-confirm-shipping-service-validate"/>
    <action name="action-purchase-lable-method-confirm-shipping-service"/>
    <action name="action-purchase-lable-method-set-selected-carrier-service"/>
  </action-group>

  <action-attrs name="action-purchase-lable-attrs-set-attributes">
    <attribute name="value" for="referenceField1" expr="eval: _parent?.saleOrderSeq"/>
    <attribute name="value" for="referenceField2" expr="eval: _parent?.externalReference"/>
  </action-attrs>

  <action-method name="action-purchase-lable-method-set-attributes">
    <call class="com.axelor.apps.sale.web.PurchaseLableController" method="setAttributes"/>
  </action-method>

  <action-method name="action-purchase-lable-method-confirm-shipping-service-validate">
    <call class="com.axelor.apps.sale.web.PurchaseLableController"
      method="confirmShippingServiceValidate"/>
  </action-method>

  <action-method name="action-purchase-lable-method-confirm-shipping-service">
    <call class="com.axelor.apps.sale.web.PurchaseLableController"
      method="confirmShippingService"/>
  </action-method>

  <action-method name="action-purchase-lable-method-set-selected-carrier-service">
    <call class="com.axelor.apps.sale.web.PurchaseLableController" method="setSelectedCarrier"/>
  </action-method>

</object-views>
